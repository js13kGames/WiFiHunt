const t={init(t){let e=this.canvas=document.getElementById(t)||t||document.querySelector("canvas");this.context=e.getContext("2d")},_noop:new Function,_tick:new Function};function e(t,e){return Math.round(t*10**e)/10**e}function n(t){return e(t*(Math.PI/180),4)}function s(t,i){const s=n(t);return[Math.cos(s),Math.sin(s)].map(t=>e(i*t,4))}function o(t){return t.split("").reduce((t,e)=>(t<<5)-t+e.charCodeAt(0)|0,0)}function d(t,e,i){const n=i,s=1-n;return[Math.round(t[0]*s+e[0]*n),Math.round(t[1]*s+e[1]*n),Math.round(t[2]*s+e[2]*n)]}t.gameLoop=function(e){const i=(e=e||{}).fps||60;let n=0;const s=1e3/i,o=1/i,d=!1===e.clearCanvas?t._noop:function(){t.context.clearRect(0,0,t.canvas.width,t.canvas.height)};let a,r,c,l;function h(){if(r=requestAnimationFrame(h),c=performance.now(),l=c-a,a=c,!(l>1e3)){for(t._tick(),n+=l;n>=s;)u.update(o),n-=s;d(),u.render()}}let u={update:e.update,render:e.render,isStopped:!0,start(){a=performance.now(),this.isStopped=!1,requestAnimationFrame(h)},stop(){this.isStopped=!0,cancelAnimationFrame(r)}};return u},function(){const e={};let n={};const s={13:"enter",27:"esc",32:"space",37:"left",38:"up",39:"right",40:"down"};for(let t=0;t<26;t++)s[65+t]=(10+t).toString(36);for(i=0;i<10;i++)s[48+i]=`${i}`;addEventListener("keydown",function(t){const i=s[t.which];n[i]=!0,e[i]&&e[i](t)}),addEventListener("keyup",function(t){n[s[t.which]]=!1}),addEventListener("blur",function(t){n={}}),t.keys={bind(t,i){[].concat(t).map(t=>{e[t]=i})},unbind(t,i){[].concat(t).map(t=>{e[t]=i})},pressed:t=>!!n[t]}}(),function(){class e{constructor(t,e){this._x=t||0,this._y=e||0}add(t,e){this.x+=(t.x||0)*(e||1),this.y+=(t.y||0)*(e||1)}clamp(t,e,i,n){this._c=!0,this._a=t,this._b=e,this._d=i,this._e=n}get x(){return this._x}get y(){return this._y}set x(t){this._x=this._c?Math.min(Math.max(this._a,t),this._d):t}set y(t){this._y=this._c?Math.min(Math.max(this._b,t),this._e):t}}t.vector=((t,i)=>new e(t,i)),t.vector.prototype=e.prototype;class i{init(e,i,n,s){for(i in e=e||{},this.position=t.vector(e.x,e.y),this.velocity=t.vector(e.dx,e.dy),this.acceleration=t.vector(e.ddx,e.ddy),this.width=this.height=0,this.context=t.context,e)this[i]=e[i];if(n=e.image)this.image=n,this.width=n.width,this.height=n.height;else if(n=e.animations){for(i in n)this.animations[i]=n[i].clone(),s=s||n[i];this._ca=s,this.width=s.width,this.height=s.height}return this}get x(){return this.position.x}get y(){return this.position.y}get dx(){return this.velocity.x}get dy(){return this.velocity.y}get ddx(){return this.acceleration.x}get ddy(){return this.acceleration.y}set x(t){this.position.x=t}set y(t){this.position.y=t}set dx(t){this.velocity.x=t}set dy(t){this.velocity.y=t}set ddx(t){this.acceleration.x=t}set ddy(t){this.acceleration.y=t}isAlive(){return this.ttl>0}collidesWith(t){return this.x<t.x+t.width&&this.x+this.width>t.x&&this.y<t.y+t.height&&this.y+this.height>t.y}update(t){this.advance(t)}render(){this.draw()}playAnimation(t){this._ca=this.animations[t],this._ca.loop||this._ca.reset()}advance(t){this.velocity.add(this.acceleration,t),this.position.add(this.velocity,t),this.ttl--,this._ca&&this._ca.update(t)}draw(){this.image?this.context.drawImage(this.image,this.x,this.y):this._ca?this._ca.render(this):(this.context.fillStyle=this.color,this.context.fillRect(this.x,this.y,this.width,this.height))}}t.sprite=(t=>(new i).init(t)),t.sprite.prototype=i.prototype}();class a{constructor(t,e){this.x=t,this.y=e}distanceTo(t){return Math.sqrt((this.x-t.x)**2+(this.y-t.y)**2)}}class r{constructor(t){this.ssid=t.ssid,this.centre=t.centre,this.radius=t.radius,this.speed=t.speed,this.jitter=t.jitter,this.encryption=t.encryption,this.password=t.password}isInRange(t){return t.distanceTo(this.centre)<=this.radius}speedAt(t,e){if(!["download","upload"].includes(e))throw new Error(`Invalid speed type '${e}'`);const i=t.distanceTo(this.centre),n=this.speed[e]/(i+.01)**2;return n<0?0:n}}const c=[{ssid:"Verizon WiFi",centre:new a(2,3),radius:24,speed:{download:10,upload:20}},{ssid:"McDonald's Wifi",centre:new a(25,18),radius:24,speed:{download:10,upload:20}},{ssid:"Joe's iPhone",centre:new a(9,-8),radius:24,speed:{download:10,upload:20}},{ssid:"NETGEAR68",centre:new a(-4,5),radius:24,speed:{download:10,upload:20}},{ssid:"Who wants free WiFi",centre:new a(45,3),radius:24,speed:{download:10,upload:20}},{ssid:"Free WiFi Initiative",centre:new a(18,-24),radius:24,speed:{download:10,upload:20}},{ssid:"Prada WiFi",centre:new a(-16,0),radius:24,speed:{download:10,upload:20},password:1265856690,encryption:"WPA2"},{ssid:"AndroidAP",centre:new a(29,-15),radius:24,speed:{download:10,upload:20}},{ssid:"Linksys",centre:new a(-5,7),radius:24,speed:{download:10,upload:20}},{ssid:"PuzzleConf",centre:new a(8,24),radius:24,speed:{download:10,upload:20}},{ssid:"[binary stuff]",centre:new a(14,-10),radius:24,speed:{download:10,upload:20}},{ssid:"Hyatt",centre:new a(18,24),radius:24,speed:{download:10,upload:20}},{ssid:"xfinitywifi",centre:new a(-19,28),radius:24,speed:{download:10,upload:20}},{ssid:"Muller home",centre:new a(-7,-7),radius:24,speed:{download:10,upload:20}}].map(t=>new r(t)),l=!0;function h(t){l&&console.log(t)}const u=50,p=["left","right","up","a","d","w"],y={download:2048,upload:1024};let w=null;const x=new a(0,0);let f=90,g=!1,v=!1,m=!1;function b(){t.init(),t.canvas.width=window.innerWidth-15,t.canvas.height=window.innerHeight;const e=new Image;e.src="images/player.png";const i=76,s=126,o=t.sprite({x:(t.canvas.width-i)/2,y:t.canvas.height-s-20,image:e}),a=t.sprite({level:100,dropRate:{active:.3,idle:.1},update(){if(a.dropRate.current=g?a.dropRate.active:a.dropRate.idle,!v){const t=a.dropRate.current/u;a.level-=t}a.level<0&&(a.level=0,I(!1),c.stop())},render(){const e=30,i=19,n=25,s=25;t.context.strokeStyle="gray",t.context.strokeRect(n,s,e,i);const o=3,r=8,c={x:n+e,y:s+(i-r)/2};t.context.fillStyle="gray",t.context.fillRect(c.x,c.y,o,r);const l=d([139,0,0],[34,228,71],a.level/100);t.context.fillStyle=`rgb(${l.join(", ")})`,t.context.fillRect(n,s,e*(a.level/100),i),t.context.fillStyle="black",t.context.font=`${i}px monospace`,t.context.fillText(`${Math.ceil(a.level)}%`,n+e+15,s+i)}}),r=t.sprite({render(){null!==w?(t.context.strokeStyle="black",t.context.fillStyle="black"):(t.context.strokeStyle="gray",t.context.fillStyle="gray");const e=40,i=90,s=n(-50),o=n(-130);for(let n=10;n<=20;n+=5)t.context.beginPath(),t.context.arc(e,i,n,s,o,!0),t.context.stroke();t.context.beginPath(),t.context.arc(e,i,5,s,o,!0),t.context.lineTo(e,i),t.context.fill(),null!==w&&(t.context.font="19px monospace",t.context.fillText(w.ssid,60,i))}}),c=t.gameLoop({fps:u,update(){o.update(),a.update(),r.update(),null===w||w.isInRange(x)||(w=null),null!==w&&(y.download-=w.speedAt(x,"download")/u,y.upload-=w.speedAt(x,"upload")/u),y.download<0&&(y.download=0),y.upload<0&&(y.upload=0),0===y.download&&0===y.upload&&(I(!0),c.stop())},render(){if(o.render(),a.render(),r.render(),v&&C({width:355,height:140},e=>{t.context.fillText("GAME PAUSED.",e.x+15,e.y+55),t.context.fillText("Press 'P' to unpause.",e.x+15,e.y+100)}),g){const e=q(x);C({width:355,height:82+25*e.length},i=>{t.context.fillText("Available Networks:",i.x+25,i.y+44);let n=75;for(const s of e)t.context.fillText(s.ssid,i.x+25,i.y+n),n+=25})}}});L(),t.keys.bind("p",A),t.keys.bind("n",M),t.keys.bind("h",R),c.start()}function k(){h(n(f));const[t,e]=s(f,1);x.x+=t,x.y+=e,h(`(${x.x}, ${x.y})`)}function _(){(f+=1)>=360&&(f=0),h(f)}function S(){(f-=1)<0&&(f=359),h(f)}function A(){v?P():F()}function M(){g?E():T()}function R(){m?$():W()}function F(){v=!0,t.keys.unbind([...p,"n","h"]),h('this is the pause "dialog box"')}function P(){v=!1,h('get rid of the pause "dialog box"'),L(),t.keys.bind("n",M),t.keys.bind("h",R)}function T(){g=!0,t.keys.unbind([...p,"p","h"]),h("available networks:");for(const t of q(x))h(t.ssid);let e=0;t.keys.bind("down",()=>{e<q(x).length-1&&e++}),t.keys.bind("up",()=>{e>0&&e--}),t.keys.bind("enter",()=>{const t=q(x)[e];if(void 0!==t.password){if(o(prompt(`Enter a ${t.encryption} password:`))!==t.password)return e=0,void alert("You entered an incorrect password")}h(w=t),E()})}function E(){g=!1,t.keys.unbind(["down","up","enter"]),h("get rid of the network list"),L(),t.keys.bind("p",A),t.keys.bind("h",R)}function W(){m=!0,t.keys.unbind([...p,"n","p"]),h("WiFiHunt"),h("--------"),h(""),h("controls:"),h("↑ / w — move forward"),h("→ / d — turn right"),h("← / a — turn left"),h("h — show this help message"),h("n — show available networks"),h("p — pause")}function $(){m=!1,L(),h('get rid of the help "dialog box"'),L(),t.keys.bind("n",M),t.keys.bind("p",A)}function I(t){h(`game up. you ${t?"won":"lost"}.`)}function L(){t.keys.bind(["up","w"],k),t.keys.bind(["left","a"],_),t.keys.bind(["right","d"],S)}function q(t){return c.filter(e=>e.isInRange(t))}function C(e,i,n=19){t.context.fillStyle="rgba(0, 0, 0, 0.25)",t.context.fillRect(0,0,t.canvas.width,t.canvas.height);const s={x:(t.canvas.width-e.width)/2,y:(t.canvas.height-e.height)/2};t.context.fillStyle="#282B30",t.context.fillRect(s.x,s.y,e.width,e.height),t.context.fillStyle="white",t.context.font=`${n}px monospace`,i(s,e)}window.onload=b;