const t={init(t){let e=this.canvas=document.getElementById(t)||t||document.querySelector("canvas");this.context=e.getContext("2d")},_noop:new Function,_tick:new Function};function e(t,e){return Math.round(t*10**e)/10**e}function n(t){return e(t*(Math.PI/180),4)}function o(t,i){const o=n(t);return[Math.cos(o),Math.sin(o)].map(t=>e(i*t,4))}function s(t){return t.split("").reduce((t,e)=>(t<<5)-t+e.charCodeAt(0)|0,0)}function d(t,e,n){const i=n,o=1-i;return[Math.round(t[0]*o+e[0]*i),Math.round(t[1]*o+e[1]*i),Math.round(t[2]*o+e[2]*i)]}t.gameLoop=function(e){const n=(e=e||{}).fps||60;let i=0;const o=1e3/n,s=1/n,d=!1===e.clearCanvas?t._noop:function(){t.context.clearRect(0,0,t.canvas.width,t.canvas.height)};let a,c,r,l;function h(){if(c=requestAnimationFrame(h),r=performance.now(),l=r-a,a=r,!(l>1e3)){for(t._tick(),i+=l;i>=o;)p.update(s),i-=o;d(),p.render()}}let p={update:e.update,render:e.render,isStopped:!0,start(){a=performance.now(),this.isStopped=!1,requestAnimationFrame(h)},stop(){this.isStopped=!0,cancelAnimationFrame(c)}};return p},function(){const e={};let n={};const o={13:"enter",27:"esc",32:"space",37:"left",38:"up",39:"right",40:"down"};for(let t=0;t<26;t++)o[65+t]=(10+t).toString(36);for(i=0;i<10;i++)o[48+i]=`${i}`;addEventListener("keydown",function(t){const i=o[t.which];n[i]=!0,e[i]&&e[i](t)}),addEventListener("keyup",function(t){n[o[t.which]]=!1}),addEventListener("blur",function(t){n={}}),t.keys={bind(t,n){[].concat(t).map(t=>{e[t]=n})},unbind(t,n){[].concat(t).map(t=>{e[t]=n})},pressed:t=>!!n[t]}}(),function(){class e{constructor(t,e){this._x=t||0,this._y=e||0}add(t,e){this.x+=(t.x||0)*(e||1),this.y+=(t.y||0)*(e||1)}clamp(t,e,n,i){this._c=!0,this._a=t,this._b=e,this._d=n,this._e=i}get x(){return this._x}get y(){return this._y}set x(t){this._x=this._c?Math.min(Math.max(this._a,t),this._d):t}set y(t){this._y=this._c?Math.min(Math.max(this._b,t),this._e):t}}t.vector=((t,n)=>new e(t,n)),t.vector.prototype=e.prototype;class n{init(e,n,i,o){for(n in e=e||{},this.position=t.vector(e.x,e.y),this.velocity=t.vector(e.dx,e.dy),this.acceleration=t.vector(e.ddx,e.ddy),this.width=this.height=0,this.context=t.context,e)this[n]=e[n];if(i=e.image)this.image=i,this.width=i.width,this.height=i.height;else if(i=e.animations){for(n in i)this.animations[n]=i[n].clone(),o=o||i[n];this._ca=o,this.width=o.width,this.height=o.height}return this}get x(){return this.position.x}get y(){return this.position.y}get dx(){return this.velocity.x}get dy(){return this.velocity.y}get ddx(){return this.acceleration.x}get ddy(){return this.acceleration.y}set x(t){this.position.x=t}set y(t){this.position.y=t}set dx(t){this.velocity.x=t}set dy(t){this.velocity.y=t}set ddx(t){this.acceleration.x=t}set ddy(t){this.acceleration.y=t}isAlive(){return this.ttl>0}collidesWith(t){return this.x<t.x+t.width&&this.x+this.width>t.x&&this.y<t.y+t.height&&this.y+this.height>t.y}update(t){this.advance(t)}render(){this.draw()}playAnimation(t){this._ca=this.animations[t],this._ca.loop||this._ca.reset()}advance(t){this.velocity.add(this.acceleration,t),this.position.add(this.velocity,t),this.ttl--,this._ca&&this._ca.update(t)}draw(){this.image?this.context.drawImage(this.image,this.x,this.y):this._ca?this._ca.render(this):(this.context.fillStyle=this.color,this.context.fillRect(this.x,this.y,this.width,this.height))}}t.sprite=(t=>(new n).init(t)),t.sprite.prototype=n.prototype}();class a{constructor(t,e){this.x=t,this.y=e}distanceTo(t){return Math.sqrt((this.x-t.x)**2+(this.y-t.y)**2)}}class c{constructor(t){this.ssid=t.ssid,this.centre=t.centre,this.radius=t.radius,this.speed=t.speed,this.jitter=t.jitter,this.encryption=t.encryption,this.password=t.password,this.cost=t.cost}isInRange(t){return t.distanceTo(this.centre)<=this.radius}speedAt(t,e){if(!["download","upload"].includes(e))throw new Error(`Invalid speed type '${e}'`);const n=t.distanceTo(this.centre),i=this.speed[e]/(n+.01)**2;return i<0?0:i}}const r=[{ssid:"Verizon WiFi",centre:new a(2,3),radius:40,speed:{download:2,upload:1}},{ssid:"McDonald's Wifi",centre:new a(25,18),radius:15,speed:{download:7,upload:14}},{ssid:"Average Joe's iPhone",centre:new a(9,-8),radius:7.5,speed:{download:3,upload:5}},{ssid:"NETGEAR68",centre:new a(-4,5),radius:24,speed:{download:8,upload:5}},{ssid:"Who wants free WiFi",centre:new a(45,3),radius:24,speed:{download:1,upload:1}},{ssid:"Free WiFi Initiative",centre:new a(18,-24),radius:100,speed:{download:.5,upload:1}},{ssid:"Prada WiFi",centre:new a(-16,0),radius:40,speed:{download:10,upload:20},cost:240},{ssid:"AndroidAP",centre:new a(29,-15),radius:15,speed:{download:10,upload:20}},{ssid:"Linksys",centre:new a(-5,7),radius:30,speed:{download:10,upload:20}},{ssid:"PuzzleConf",centre:new a(8,24),radius:24,speed:{download:10,upload:20}},{ssid:"Azure Diamond",centre:new a(14,-10),radius:35,speed:{download:10,upload:20},password:1265856690,encryption:"WPA2"},{ssid:"Hyatt",centre:new a(18,24),radius:20,speed:{download:7.5,upload:10},cost:300},{ssid:"xfinitywifi",centre:new a(-19,28),radius:20,speed:{download:5,upload:15}},{ssid:"xfinitywifi",centre:new a(40,-5),radius:40,speed:{download:10,upload:20},cost:160},{ssid:"Muller home",centre:new a(-7,-7),radius:33,speed:{download:10,upload:20}},{ssid:"⏩",centre:new a(57.1,57.1),radius:.5,speed:{download:100,upload:100}}].map(t=>new c(t)),l=50,h=["left","right","up","a","d","w"];let p=null;const u=new a(0,0);let x=90,w=!1,y=!1,f=0;window.onload=(()=>{t.init();const i=t.gameLoop({fps:50,update(){a.update(),c.update(),l.update(),v.update(),null===p||p.isInRange(u)||(p=null)},render(){if(t.context.save(),b.render(),a.render(),c.render(),l.render(),g.render(),v.render(),m.render(),k.render(),y&&I({width:355,height:140},e=>{t.context.fillText("GAME PAUSED.",e.x+15,e.y+55),t.context.fillText("Press 'P' to unpause.",e.x+15,e.y+100)}),w){const e=F(u);I({width:355,height:82+25*e.length},(n,i)=>{t.context.fillText("Available Networks:",n.x+25,n.y+44);let o=75;for(let s=0;s<e.length;s++){const d=e[s];t.context.fillStyle=f===s?"hsl(0, 0%, 75%)":"white",t.context.fillText(d.ssid,n.x+25,n.y+o);const a=n.x+i.width-25-19,c=void 0!==d.password,r=d.cost>0;c&&t.context.fillText("🔒",a,n.y+o),r&&t.context.fillText("💰",a,n.y+o),o+=25}})}}});t.canvas.width=window.innerWidth-15,t.canvas.height=window.innerHeight,E(),t.keys.bind("p",A),t.keys.bind("n",R),i.start();const a=t.sprite({render(){const e=new Image;e.src="images/player.png",t.context.drawImage(e,(t.canvas.width-e.width)/2,t.canvas.height-e.height-20)}}),c=t.sprite({level:100,dropRate:{active:.3,idle:.1},update(){if(c.dropRate.current=w?c.dropRate.active:c.dropRate.idle,!y){const t=c.dropRate.current/50;c.level-=t}c.level<0&&(c.level=0,P(!1),i.stop())},render(){const e=30,n=19,i=25,o=25;t.context.strokeStyle="gray",t.context.strokeRect(i,o,e,n);const s=3,a=8,r={x:i+e,y:o+(n-a)/2};t.context.fillStyle="gray",t.context.fillRect(r.x,r.y,s,a);const l=d([139,0,0],[34,228,71],c.level/100);t.context.fillStyle=`rgb(${l.join(", ")})`,t.context.fillRect(i,o,e*(c.level/100),n),t.context.fillStyle="black",t.context.font=`${n}px monospace`,t.context.fillText(`${Math.ceil(c.level)}%`,i+e+15,o+n)}}),l=t.sprite({render(){null!==p?(t.context.strokeStyle="black",t.context.fillStyle="black"):(t.context.strokeStyle="gray",t.context.fillStyle="gray");const e=40,i=90,o=n(-50),s=n(-130);for(let n=10;n<=20;n+=5)t.context.beginPath(),t.context.arc(e,i,n,o,s,!0),t.context.stroke();t.context.beginPath(),t.context.arc(e,i,5,o,s,!0),t.context.lineTo(e,i),t.context.fill(),null!==p&&(t.context.font="19px monospace",t.context.fillText(p.ssid,70,i))}}),g=t.sprite({remaining:500,render(){const e=25,n=130;t.context.fillStyle="hsl(50, 90%, 40%)",t.context.font="19px monospace",t.context.fillText("💰",e,n),t.context.fillStyle="black",t.context.fillText(g.remaining,e+45,n)}}),v=t.sprite({download:2048,upload:1024,update(){null!==p&&(v.download-=p.speedAt(u,"download")/50,v.upload-=p.speedAt(u,"upload")/50),v.download<0&&(v.download=0),v.upload<0&&(v.upload=0),0===v.download&&0===v.upload&&(P(!0),i.stop())},render(){t.context.fillStyle="black",t.context.font="19px monospace",t.context.fillText(`↓ Goal: ${Math.ceil(v.download)} MiB`,25,190),t.context.fillText(`↑ Goal: ${Math.ceil(v.upload)} MiB`,25,220)}}),m=t.sprite({render(){null!==p&&(t.context.fillStyle="black",t.context.font="19px monospace",t.context.fillText(`↓ Speed: ${Math.ceil(1024*p.speedAt(u,"download"))} KiB/s`,25,270),t.context.fillText(`↑ Speed: ${Math.ceil(1024*p.speedAt(u,"upload"))} KiB/s`,25,300))}}),k=t.sprite({render(){t.context.font="16px monospace",t.context.fillText(`(${e(u.x,2)}, ${e(u.y,2)})`,25,t.canvas.height-20),t.context.fillText(`${x}°`,25,t.canvas.height-45)}}),b=t.sprite({width:t.canvas.width/3,render(){t.context.save(),t.context.translate(t.canvas.width/2,t.canvas.height-80),t.context.rotate(n(-(90-x))),t.context.translate(-t.canvas.width/2,-(t.canvas.height-80));const e=Math.abs(Math.sin(n(x)+.1));t.context.fillStyle="hsl(220, 2%, 35%)",t.context.fillRect(b.width,-300,b.width,t.canvas.height/e+300+100),t.context.fillStyle="white";for(let e=10*(u.y%200-200);e<=700;e+=200)t.context.fillRect((t.canvas.width-25)/2,e,25,100);t.context.font="200px monospace";for(let e=10*(u.y%200-200);e<=700;e+=150)t.context.fillText("🌳",b.width-150,e+25);for(let e=10*(u.y%200-200);e<=700;e+=175)t.context.fillText("🌳",b.width+350,e);t.context.restore()}});function _(){const[t,e]=o(x,1);u.x+=t,u.y+=e}function S(){const[t,e]=o(x,1);u.x-=t,u.y-=e}function M(){x%5!=0&&(x+=1),x<180&&(x+=5)}function T(){x%5!=0&&(x+=1),x>0&&(x-=5)}function A(){y?(y=!1,E(),t.keys.bind("n",R)):(y=!0,t.keys.unbind([...h,"n","h"]))}function R(){w?$():(w=!0,f=0,t.keys.unbind([...h,"p","h"]),t.keys.bind("down",()=>{f<F(u).length-1&&f++}),t.keys.bind("up",()=>{f>0&&f--}),t.keys.bind("enter",()=>{const t=F(u),e=t[f];if(void 0!==e.cost&&e.cost>0){const t=window.confirm(`Do you wish to pay ${e.cost} to use this network?`);if(!t)return;if(!(g.remaining>=e.cost))return void alert("You don't have enough money to afford this network");g.remaining-=e.cost,e.cost=0}if(void 0!==e.password){const t=prompt(`Enter a ${e.encryption} password:`);if(s(t)!==e.password)return void alert("You entered an incorrect password")}p=e,$()}))}function $(){w=!1,t.keys.unbind(["down","up","enter"]),E(),t.keys.bind("p",A)}function P(t){console.log(`game up. you ${t?"won":"lost"}.`)}function E(){t.keys.bind(["up","w"],_),t.keys.bind(["down","s"],S),t.keys.bind(["left","a"],M),t.keys.bind(["right","d"],T)}function F(t){return r.filter(e=>e.isInRange(t))}function I(e,n){t.context.fillStyle="hsla(0, 0%, 0%, 0.25)",t.context.fillRect(0,0,t.canvas.width,t.canvas.height);const i={x:(t.canvas.width-e.width)/2,y:(t.canvas.height-e.height)/2};t.context.fillStyle="hsl(218, 9%, 17%)",t.context.fillRect(i.x,i.y,e.width,e.height),t.context.fillStyle="white",t.context.font="19px monospace",n(i,e)}});